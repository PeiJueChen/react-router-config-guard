{"version":3,"file":"react-router-config-guard.js","sources":["../../node_modules/@babel/runtime/helpers/esm/extends.js","../../node_modules/@babel/runtime/helpers/esm/typeof.js","../../node_modules/@babel/runtime/helpers/esm/arrayWithHoles.js","../../node_modules/@babel/runtime/helpers/esm/iterableToArrayLimit.js","../../node_modules/@babel/runtime/helpers/esm/arrayLikeToArray.js","../../node_modules/@babel/runtime/helpers/esm/unsupportedIterableToArray.js","../../node_modules/@babel/runtime/helpers/esm/nonIterableRest.js","../../node_modules/@babel/runtime/helpers/esm/slicedToArray.js","../../node_modules/@babel/runtime/helpers/esm/defineProperty.js","../src/Contexts.jsx","../src/RouterGuard.jsx","../src/hooks/usePrevious.jsx","../src/ContextProvider.jsx","../src/ReactRouterConfigGuard.jsx"],"sourcesContent":["export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","export default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","export default function _arrayWithHoles(arr) {\n  if (Array.isArray(arr)) return arr;\n}","export default function _iterableToArrayLimit(arr, i) {\n  if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return;\n  var _arr = [];\n  var _n = true;\n  var _d = false;\n  var _e = undefined;\n\n  try {\n    for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n      _arr.push(_s.value);\n\n      if (i && _arr.length === i) break;\n    }\n  } catch (err) {\n    _d = true;\n    _e = err;\n  } finally {\n    try {\n      if (!_n && _i[\"return\"] != null) _i[\"return\"]();\n    } finally {\n      if (_d) throw _e;\n    }\n  }\n\n  return _arr;\n}","export default function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}","export default function _nonIterableRest() {\n  throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithHoles from \"./arrayWithHoles.js\";\nimport iterableToArrayLimit from \"./iterableToArrayLimit.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableRest from \"./nonIterableRest.js\";\nexport default function _slicedToArray(arr, i) {\n  return arrayWithHoles(arr) || iterableToArrayLimit(arr, i) || unsupportedIterableToArray(arr, i) || nonIterableRest();\n}","export default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","import { createContext } from \"react\";\nexport const FromRouteContext = createContext(null);","\nimport React from \"react\";\nimport { Redirect, Route } from \"react-router\";\nimport { useState, useContext } from \"react\";\nimport { memo, useCallback, useEffect } from \"react\"\nimport { __RouterContext as RouterContext } from 'react-router';\nimport { FromRouteContext } from './Contexts.jsx';\n\n\n// const from = createContext(FromRouteContext);\n// const to = createContext(RouterContext);\n// class RouterGuard2 extends React.PureComponent {\n\n//     hasRouteGuard\n//     guardToRedirect = false;\n//     isRedirect = false;\n//     redirectPath = \"\";\n//     constructor(props) {\n//         super(props);\n//         this.hasRouteGuard = !!this.props.routerBeforeEach;\n//         this.state = {\n//             routeGuardFinished: false,\n//         }\n//     }\n\n//     getTo() {\n//         return { ...to, meta: this.props.route.meta || {}, route: this.props.route }\n//     }\n\n//     componentDidMount() {\n//         if (!this.hasRouteGuard) {\n//             return;\n//         }\n\n//         this.props.routerBeforeEach(this.getTo(), from, (to) => {\n//             if (!to) {\n//                 this.guardToRedirect = false;\n//                 this.setState({\n//                     routeGuardFinished: true\n//                 })\n//             } else {\n//                 if (typeof to === 'string') {\n//                     this.redirectPath = to;\n//                     this.isRedirect = false;\n//                     this.guardToRedirect = true;\n//                     this.setState({\n//                         routeGuardFinished: true\n//                     })\n//                 } else if (typeof to === 'object' && (typeof to.path === 'string' || typeof to.name === 'string')) {\n//                     this.redirectPath = to.path || to.name;\n//                     this.isRedirect = to.replace || false;\n//                     this.guardToRedirect = false;\n//                     this.setState({\n//                         routeGuardFinished: true\n//                     })\n//                 } else {\n//                     console.log(`Your next format is incorrect, should be : next('/') or next({ path: '/' }) or next({ path: '/', replace: true})`);\n//                     this.guardToRedirect = false;\n//                     this.setState({\n//                         routeGuardFinished: true\n//                     })\n//                 }\n//             }\n//         })\n\n//     }\n\n//     render() {\n\n//         var { routerAfterEach, route, history } = this.props\n\n//         if (!this.state.routeGuardFinished) {\n//             return null;\n//         }\n\n//         if (this.guardToRedirect && this.redirectPath) {\n//             routerAfterEach && routerAfterEach(this.getTo());\n//             if (this.isRedirect) {\n//                 return <Redirect to={this.redirectPath} {...this.props} />\n//             } else {\n//                 if (history) {\n//                     history.push(this.redirectPath);\n//                     return null;\n//                 } else {\n//                     return <Route to={this.redirectPath} {...this.props} />\n//                 }\n//             }\n//         }\n\n//         routerAfterEach && routerAfterEach(this.getTo());\n//         return React.createElement(route.component, this.props);\n//     }\n// }\n\n\nconst RouterGuard = memo(function (props) {\n    // console.log(\"init RouterGuard\");\n\n    var { routerBeforeEach, routerAfterEach, route, history } = props\n    const from = useContext(FromRouteContext);\n    const to = useContext(RouterContext);\n\n    const getTo = useCallback(() => {\n        return { ...to, meta: route.meta || {}, route }\n    }, [to, route])\n    // const hasRouteGuard = !!routerBeforeEach;\n    const [routeGuardFinished, setRouteGuardFinished] = useState(false);\n    const [redirectPath, setRedirectPath] = useState(\"\");\n    const [guardToRedirect, setGuardToRedirect] = useState(false);\n    const [isRedirect, setIsRedirect] = useState(false);\n\n    const hook = useCallback((to, from, next) => {\n        routerBeforeEach && routerBeforeEach(to, from, next);\n    }, [routerBeforeEach])\n\n    useEffect(() => {\n\n        if (!routerBeforeEach) {\n            setRouteGuardFinished(true);\n            setGuardToRedirect(false);\n        } else {\n            hook(getTo(), from, (to) => {\n                if (!to) {\n                    setGuardToRedirect(false);\n                    setRouteGuardFinished(true);\n                } else {\n                    // next('/') or next({ path: '/' }) -> redirect\n                    if (typeof to === 'string') {\n                        setRedirectPath(to);\n                        setIsRedirect(false);\n                        setGuardToRedirect(true);\n                        setRouteGuardFinished(true);\n                    } else if (typeof to === 'object' && (typeof to.path === 'string' || typeof to.name === 'string')) {\n                        setRedirectPath(to.path || to.name);\n                        setIsRedirect(to.replace || false);\n                        setGuardToRedirect(true);\n                        setRouteGuardFinished(true);\n                    } else {\n                        console.log(`Your next format is incorrect, should be : next('/') or next({ path: '/' }) or next({ path: '/', replace: true})`);\n                        setGuardToRedirect(false);\n                        setRouteGuardFinished(true);\n                    }\n                }\n\n            })\n        }\n\n// eslint-disable-next-line react-hooks/exhaustive-deps\n    }, [hook])\n\n    if (!routeGuardFinished) {\n        return null;\n    }\n\n    if (guardToRedirect && redirectPath) {\n        routerAfterEach && routerAfterEach(getTo());\n        if (isRedirect) {\n            return <Redirect to={redirectPath} {...props} />\n        } else {\n            if (history) {\n                history.push(redirectPath);\n                return null;\n            } else {\n                return <Route to={redirectPath} {...props} />\n            }\n        }\n    }\n\n    routerAfterEach && routerAfterEach(getTo());\n\n    return React.createElement(route.component, props);\n})\n\nexport default RouterGuard;","import { useDebugValue, useEffect, useRef } from 'react';\n\n/**\n * React hook for storing the previous value of the\n * given value.\n *\n * @param value the value to store\n * @returns the previous value\n */\nfunction usePrevious(value) {\n    const ref = useRef(value);\n\n    useEffect(() => {\n        ref.current = value;\n    });\n\n    // Can be used to display custom hook tags in React developer tools. \n    // useDebugValue(ref.current);\n\n    return ref.current;\n}\n\nexport default usePrevious;\n","import React from \"react\";\nimport { memo, useContext } from 'react';\nimport { __RouterContext as RouterContext } from 'react-router';\nimport usePrevious from './hooks/usePrevious.jsx';\nimport { FromRouteContext } from './Contexts.jsx';\nconst ContextProvider = memo(function ({ childrens }) {\n    const routerContext = useContext(RouterContext);\n    const from = usePrevious(routerContext);\n    return <FromRouteContext.Provider value={from}>{childrens}</FromRouteContext.Provider>\n\n})\n\nexport default ContextProvider;","\nimport React from \"react\";\nimport { Switch } from \"react-router\";\nimport RouterGuard from './RouterGuard.jsx';\nimport ContextProvider from './ContextProvider.jsx';\n\nconst reactRouter = require('react-router');\n\nvar _extends = function () {\n    _extends = Object.assign || function (target) {\n        for (var i = 1; i < arguments.length; i++) {\n            var source = arguments[i];\n\n            for (var key in source) {\n                if (Object.prototype.hasOwnProperty.call(source, key)) {\n                    target[key] = source[key];\n                }\n            }\n        }\n\n        return target;\n    };\n\n    return _extends.apply(this, arguments);\n}\n\n\n\nvar routerBeforeEach;\n\nvar routerAfterEach;\n\nexport const setRouterEach = (before, after) => {\n    routerBeforeEach = before;\n    routerAfterEach = after;\n}\n\n// renderRoutes(routes, extraProps = {}, switchProps = {})\nexport function renderRoutes(routes, extraProps = {}, switchProps = {}) {\n\n    if (extraProps === void 0) {\n        extraProps = {};\n    }\n\n    if (switchProps === void 0) {\n        switchProps = {};\n    }\n\n    if (!routes) return null;\n\n\n    return (\n        <ContextProvider childrens={\n            <Switch switchProps={switchProps} extraProps={extraProps}>\n                {\n\n                    routes.map((route, i) => {\n                        const genParams = (props) => (_extends({}, props, {}, extraProps, {\n                            route: route\n                        }));\n                        const render_ = (props) => {\n                            let params = genParams(props);\n                            return route.render ?\n                                route.render(params) :\n                                <RouterGuard routerBeforeEach={routerBeforeEach} routerAfterEach={routerAfterEach} {...params} />\n                        }\n                        return React.createElement(reactRouter.Route, {\n                            key: route.key || i,\n                            path: route.path,\n                            exact: route.exact,\n                            strict: route.strict,\n                            render: render_\n                        })\n                    })\n                }\n\n            </Switch>\n        }>\n\n        </ContextProvider>\n\n    )\n}\n\nexport function matchRoutes(routes, pathname,\n    /*not public API*/\n    branch) {\n    if (branch === void 0) {\n        branch = [];\n    }\n\n    routes.some(function (route) {\n        var match = route.path ? reactRouter.matchPath(pathname, route) : branch.length ? branch[branch.length - 1].match // use parent match\n            : reactRouter.Router.computeRootMatch(pathname); // use default \"root\" match\n\n        if (match) {\n            branch.push({\n                route: route,\n                match: match\n            });\n\n            if (route.routes) {\n                matchRoutes(route.routes, pathname, branch);\n            }\n        }\n\n        return match;\n    });\n    return branch;\n}\n\n"],"names":["arrayLikeToArray","arrayWithHoles","iterableToArrayLimit","unsupportedIterableToArray","nonIterableRest","FromRouteContext","createContext","RouterGuard","memo","props","routerBeforeEach","routerAfterEach","route","history","from","useContext","to","RouterContext","getTo","useCallback","meta","useState","routeGuardFinished","setRouteGuardFinished","redirectPath","setRedirectPath","guardToRedirect","setGuardToRedirect","isRedirect","setIsRedirect","hook","next","useEffect","path","name","replace","console","log","React","Redirect","push","Route","createElement","component","usePrevious","value","ref","useRef","current","ContextProvider","childrens","routerContext","reactRouter","require","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","setRouterEach","before","after","renderRoutes","routes","extraProps","switchProps","Switch","map","genParams","render_","params","render","exact","strict","matchRoutes","pathname","branch","some","match","matchPath","Router","computeRootMatch"],"mappings":"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"}